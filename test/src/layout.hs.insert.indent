-- Figure 2.1 from the Haskell2010 report
v
module AStack( Stack, push, pop, top, size ) where
v
data Stack a = Empty
1            2 v
             | MkStack a (Stack a)
1            v

v            1
push :: a -> Stack a -> Stack a
v
push x s = MkStack x s
1          v

v
size :: Stack a -> Int
v
size s = length (stkToLst s)  where
1 v        2
           stkToLst  Empty         = []
3          1                         v          2
           stkToLst (MkStack x s)  = x:xs where xs = stkToLst s
3          2                                    1    v

1          2                                    3    v
pop :: Stack a -> (a, Stack a)
v
pop (MkStack x s)
1 5 v             4              3      2
  = (x, case s of r -> i r where i x = x) -- (pop Empty) is an error
5 4 v             3              2      1

v 1               2              3      4
top :: Stack a -> a
v
top (MkStack x s) = x                     -- (top Empty) is an error
v